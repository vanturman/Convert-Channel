最近学习到了操作系统安全分级的相关知识，对BLP模型有了一定的了解。针对实现了MAC安全机制的操作系统来说，可以有效地防御木马的攻击。但是由于MAC安全机制仍存在一些安全漏洞，不能解决隐蔽通道的问题。记录下本次自己构造了两个隐蔽通道和实现的过程，今后想回顾的时候可以回来看看。  

一、实现环境  
---   
支持开启SeLinux的Linux系统，开启MAC


二、场景分析  
---   
（1）选择的隐蔽信道名称：进程描述符信道。  
（2）信道类型：持久变量类型  
（3）隐蔽信道三元组：发送方（fork函数）、last_pid、接收方（fork函数的返回值）。  
（4）存在条件：系统中所有的进程共享同一个进程描述符列表。无论系统采用何种安全策略，高安全级进程与低安全级进程都要共享这个列表，并且可以通过建立子进程得知当前可用进程描述符信道的值。如果系统的进程描述符信道表是干净的，即没有其它进程消耗进程描述符信道表，高低进程就可以根据进程描述符信道增长的情况了解其它进程的工作情况。  
（5）发送方动作：发送方读取机密文件，然后，根据该文件内容的当前字节的ASIIC码决定创建的子进程数目，待接收方读取该信息后，删除这些子进程。  
（6）接收方动作：创建子进程，得到当前的进程描述符信道，然后与上次创建子进程得到的进程描述符信道对比，可以知道其它进程创建的子进程数目。解释所得到的信息。  
（7）同步机制：采用sleep（秒）/usleep（微秒）制造同步。当一个进程sleep时，就将CPU的控制权交给其他进程，直到sleep时间已到，重新获得CPU的控制权。  

三、具体攻击流程设计
---     
（1）启动到隐蔽通道处理前的安全核SeLinux。  
（2）创建两个用户user\_h和user\_l，user\_h的安全范畴包含user\_l的安全范畴，user\_h的密级高于user\_l的密级。此外，设置用户主目录密级与用户密级相同；将两个用户主目录自主访问控制权限放开，即均通过chmod命令将其权限设为0777，允许u,g,o可读、写和执行。  
（3）利用两个安全等级不同的用户，检验SeLinux的安全性，“不可上读，不可下写”。即，高级用户可以读低密级文件，但是不能创建低密级文件，也不能通过拷贝等方式向下传递信息；低密级用户也无法读高密级文件。  
（4）发送方读取机密文件，然后，根据该文件内容的当前字节的ASIIC码决定创建的子进程数目，待接收方读取该信息后，删除这些子进程。接收方创建子进程，得到当前的进程描述符信道，然后与上次创建子进程得到的进程描述符信道对比，可以知道其它进程创建的子进程数目，解释出得到的信息。编程实现sender.cpp和receiver.cpp，完成上述功能。  
（5）检验（4）的结果，测试隐蔽信道是否能够成功传输信息。同时，对比之前的操作，分析结果。  
